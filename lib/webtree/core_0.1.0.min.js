/*! Core 2014-03-03 */
function CacheHandlerProvider(){"use strict";var a,b=[];this.setProvider=function(b){a=b},this.setCacheRules=function(a){b=a},this.$get=["$injector","$cacheFactory","$timeout","$q","jsonFormatter",function(c,d,e,f,g){var h,i,j,k=d("CACHED_REQUESTS"),l=c.get(a),m=this;return m.filterData=function(a,c){if(c&&c.TIMESTAMP&&b.length>0)for(i=(new Date).getTime(),j=0;j<b.length;j+=1)if(h=b[j],h.key.indexOf(a)>=0){if(i-c.TIMESTAMP>h.expiration)return null;break}return c},{enqueueRequest:function(a,b){var c=f.defer();return k.put(g.wrap(a),{defer:c,updateCache:b}),c.promise},dequeueRequest:function(a,b,c){{var d=k.get(g.wrap(c));this.getCachedData(c)}d&&(a?d.defer.resolve(b):d.defer.reject(b),k.remove(g.wrap(c)))},cacheData:function(a,b){var c=k.get(a);c&&c.updateCache&&(b.TIMESTAMP=(new Date).getTime(),l.add(a,b))},getCachedData:function(a){var b=l.get(a);return m.filterData(a,b)}}}]}var wtCore=angular.module("wt-core",[]).config(function(a){"use strict";var b=a.provider("cacheHandler",CacheHandlerProvider);b.setProvider("localStorageProxy")});wtCore.service("authentication",["$rootScope","$http","$q","wtCoreConfig",function(a,b,c,d){"use strict";var e;this.authenticate=function(f,g){function h(a){e=a.sessionId,j.resolve(e)}function i(b){j.reject(b),a.$on("UNAUTHORIZED",b)}var j=c.defer();return b.post(d.authentication.url,{email:f,password:g}).success(h).error(i),j.promise},this.getSessionId=function(){return e}}]),wtCore.service("bootstrapper",["$q",function(a){"use strict";var b={};this.setDependency=function(c,d){var e=a.defer(),f=!1;return b[c]?e=b[c].defer:(e=a.defer(),b[c]={defer:e,resolved:f}),d&&!b[c].resolved&&d(),e.promise},this.resolve=function(a){angular.forEach(b,function(b,c){c===a&&(b.resolved=!0,b.defer.resolve())})}}]),wtCore.service("eventHub",["$rootScope","$log","jsonFormatter",function(a,b,c){"use strict";this.fire=function(d){var e="";e=1===arguments.length?" with no arguments":" with arguments "+c.wrap(Array.prototype.slice.call(arguments,1)),b.debug("[EVENT] - Calling event ["+d+"]"+e),a.$broadcast.apply(a,arguments)}}]),wtCore.factory("$exceptionHandler",["$injector",function(a){"use strict";return function(b){var c=a.get("$log"),d=a.get("eventHub");c.error(b.message),d.fire("APPLICATION_ERROR",b.message)}}]),wtCore.service("httpProxy",["$http","$timeout","cacheHandler","jsonFormatter",function(a,b,c,d){"use strict";function e(a){a.data||(a.data="");var b=a.url+d.wrap(a.data);return b}function f(a,b,c,d){return{data:a,status:b,headers:c,config:d}}function g(a,b,d,g){c.cacheData(e(g),a),c.dequeueRequest(!0,f(a,b,d,g),e(g))}function h(a,b,d,g){c.dequeueRequest(!1,f(a,b,d,g),e(g))}this.hit=function(d,i,j){var k=c.getCachedData(e(d));return i=i||!k,i?a(d).success(g).error(h):b(function(){c.dequeueRequest(!0,f(k,304,function(){},d),e(d))}),c.enqueueRequest(e(d),j)}}]),wtCore.service("jsonFormatter",function(){"use strict";this.isJSON=function(a){var b=!0;if("object"!=typeof a)try{JSON.parse(a)}catch(c){b=!1}return b},this.wrap=function(a){return angular.isString(a)?a:this.isJSON(a)?JSON.stringify(a):a.toString()},this.unwrap=function(a){return this.isJSON(a)?JSON.parse(a):a}}),wtCore.service("localStorageProxy",["$window","jsonFormatter",function(a,b){"use strict";this.clear=function(){a.localStorage.clear()},this.get=function(c){return b.unwrap(a.localStorage.getItem(b.wrap(c)))},this.getAll=function(){var b,c,d={};for(b=0;b<a.localStorage.length;b+=1)c=a.localStorage.key(b),d[c]=a.localStorage.getItem(c);return d},this.add=function(c,d){a.localStorage.setItem(b.wrap(c),b.wrap(d))},this.remove=function(c){a.localStorage.removeItem(b.wrap(c))},this.execute=function(){}}]),wtCore.service("sessionStorageProxy",["$window","jsonFormatter",function(a,b){"use strict";this.clear=function(){a.sessionStorage.clear()},this.get=function(c){return b.unwrap(a.sessionStorage.getItem(b.wrap(c)))},this.getAll=function(){var b,c,d={};for(b=0;b<a.sessionStorage.length;b+=1)c=a.sessionStorage.key(b),d[c]=a.sessionStorage.getItem(c);return d},this.add=function(c,d){a.sessionStorage.setItem(b.wrap(c),b.wrap(d))},this.remove=function(c){a.sessionStorage.removeItem(b.wrap(c))},this.execute=function(){}}]);